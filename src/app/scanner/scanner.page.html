<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>Scanner Prodotti</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  
  <!-- Desktop Layout -->
  <div *ngIf="isDesktop" class="desktop-scanner-layout">
    
    <!-- Header Section -->
    <div class="scanner-header desktop-header">
      <div class="header-content">
        <h1>
          <ion-icon name="barcode-outline"></ion-icon>
          Scanner Prodotti
        </h1>
        <p>Inserisci il codice EAN o scansiona il barcode per analizzare il prodotto</p>
      </div>
    </div>
    
    <!-- Search Section -->
    <div class="desktop-search-section">
      <ion-card class="search-card">
        <ion-card-header>
          <ion-card-title>
            <ion-icon name="search-outline"></ion-icon>
            Ricerca per Codice EAN
          </ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <div class="search-container">
            <ion-item>
              <ion-label position="stacked" style="color: #505050">Codice Barcode (EAN)</ion-label>
              <ion-input 
                [(ngModel)]="searchCode" 
                placeholder="es. 8076809513726"
                type="text"
                (keyup.enter)="searchByCode()">
              </ion-input>
            </ion-item>
            
            <ion-button 
              expand="block" 
              (click)="searchByCode()"
              [disabled]="!searchCode || isLoading"
              class="search-button">
              <ion-icon name="search-outline" slot="start"></ion-icon>
              <span *ngIf="!isLoading">Cerca Prodotto</span>
              <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
            </ion-button>
          </div>
        </ion-card-content>
      </ion-card>
      
      <!-- Future ESP32-CAM Integration -->
      <ion-card class="camera-card">
        <ion-card-header>
          <ion-card-title>
            <ion-icon name="camera-outline"></ion-icon>
            Scansione Camera (Presto Disponibile)
          </ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Connetti una ESP32-CAM per la scansione automatica</p>
          <ion-button fill="solid" disabled>
            <ion-icon name="camera-outline" slot="start"></ion-icon>
            Configura Camera
          </ion-button>
        </ion-card-content>
      </ion-card>
    </div>
    
  </div>
  
  <!-- Mobile Layout -->
  <div *ngIf="isMobile" class="mobile-scanner-layout">
    
    <!-- Scanner Camera View -->
    <div *ngIf="isScanning" class="camera-scanner">
      <div class="scanner-overlay">
        <div class="scan-area">
          <div class="scan-line"></div>
        </div>
        <div class="scanner-instructions">
          <p>Inquadra il codice a barre del prodotto</p>
          <ion-button class="annulla-button" fill="clear" color="light" (click)="stopScanning()">
            <ion-icon name="close-outline"></ion-icon>
            Annulla
          </ion-button>
        </div>
      </div>
    </div>
    
    <!-- Mobile Controls -->
    <div *ngIf="!isScanning" class="mobile-controls">
      <div class="scanner-header mobile-header">
        <h1>Scanner Prodotti</h1>
        <p>Scansiona il barcode per analizzare il prodotto</p>
      </div>
      
      <!-- Primary Scanner Button -->
      <div class="scan-button-container">
        <ion-button 
          expand="block" 
          size="large" 
          class="primary-scan-button">
          <ion-icon name="scan-outline" slot="start"></ion-icon>
          Scansiona Prodotto
        </ion-button>
      </div>
      
      <!-- Manual Input Option -->
      <div class="manual-input-section">
        <ion-button 
          fill="solid" 
          expand="block" 
          (click)="showManualInput = !showManualInput">
          <ion-icon name="create-outline" slot="start"></ion-icon>
          Inserisci Codice Manualmente
        </ion-button>
        
        <div *ngIf="showManualInput" class="manual-input-form">
          <ion-item>
            <ion-label position="stacked">Codice Barcode</ion-label>
            <ion-input 
              [(ngModel)]="searchCode" 
              placeholder="es. 8076809513726"
              type="text">
            </ion-input>
          </ion-item>
          
          <ion-button 
            expand="block" 
            (click)="searchByCode()"
            [disabled]="!searchCode || isLoading"
            class="manual-search-button">
            <ion-icon name="search-outline" slot="start"></ion-icon>
            <span *ngIf="!isLoading">Cerca</span>
            <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
          </ion-button>
        </div>
      </div>
    </div>
    
  </div>

</ion-content>


