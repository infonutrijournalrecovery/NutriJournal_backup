<ion-header>
  <ion-toolbar color="light">
    <ion-title class="title">Statistiche</ion-title>
  </ion-toolbar>
</ion-header>


<ion-content class="ion-padding stats-page">
<!-- Metric selector -->
<div class="metric-selector">
<div class="metric-scroll" style="overflow-x: auto; white-space: nowrap;">
  <div class="metrics-row" style="display: inline-flex;">
    <button
      *ngFor="let m of metrics"
      (click)="selectMetric(m)"
      [class.active]="selectedMetric === m"
      class="metric-pill"
      style="margin-right: 8px;"
    >
      {{ m }}
    </button>
  </div>
</div>
</div>


<!-- Period selector -->
<div class="period-selector">
  <ion-segment [value]="selectedPeriod" (ionChange)="selectPeriod($event.detail.value)">
    <ion-segment-button *ngFor="let p of periods" [value]="p">
      {{ p }}
    </ion-segment-button>
  </ion-segment>
</div>


<!-- Chart card -->
<div class="chart-card">
<div *ngIf="lineChartData">
  <canvas
    baseChart
    [data]="lineChartData"
    [type]="'line'"
    [options]="lineChartOptions">
  </canvas>
</div>
</div>


<!-- Quick stats -->
<div class="quick-stats">
  <div class="stat-card">
    <div class="stat-label">{{selectedMetric}} medio</div>
    <div class="stat-value">{{ formatValue(quickStats.average) }}</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Trend</div>
    <div class="stat-value">{{ quickStats.trend !== 0 ? (formatValue(quickStats.trend) + '%') : '-' }}</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Periodo</div>
    <div class="stat-value">{{ quickStats.period }}</div>
  </div>
</div>
</ion-content>