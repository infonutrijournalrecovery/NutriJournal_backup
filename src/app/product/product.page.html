<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/pantry"></ion-back-button>
    </ion-buttons>
    <ion-title>Visualizza prodotto</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
<!--
  <ion-button fill="solid" class="nav-btn-pantry" [disabled]="alreadyInPantry()">
    Aggiungi in dispensa
  </ion-button>

  <ion-button fill="solid" class="nav-btn-meal" (click)="openMealActionSheet()">
    Aggiungi al pasto
  </ion-button>
-->
  <ion-list lines="none" class="product-details">

    <ion-item>
      <ion-label>
        <strong>NOME:</strong>
        <div class="value">{{ prodotto.nome }}</div>
      </ion-label>
    </ion-item>

    <ion-item>
      <ion-label>
        <strong>MARCA:</strong>
        <div class="value">{{ prodotto.marca }}</div>
      </ion-label>
    </ion-item>

    <ion-item>
      <ion-label>
        <strong>QUANTITÃ€:</strong>
        <div class="value">{{ prodotto.quantita }}</div>
      </ion-label>
    </ion-item>

    <ion-item>
      <ion-label>
        <strong>ADDITIVI:</strong>
        <div class="value-list">
          <div *ngIf="prodotto.additivi?.length; else noAdditivi">
            <div *ngFor="let additivo of prodotto.additivi" class="additivo-wrapper">
              <!-- Pill con codice additivo e colore -->
              <div class="additivo-pill"
                   [ngClass]="{
                     'Pericoloso': additivo.pericolosita === 2,
                     'Potenzialmente-pericoloso': additivo.pericolosita === 1,
                     'Innocuo': additivo.pericolosita === 0
                   }">
                {{ additivo.nome }}
              </div>
              <!-- Commento accanto -->
              <span class="additivo-comment">
                {{ additivo.pericolosita === 2 ? 'Pericoloso' : additivo.pericolosita === 1 ? 'Potenzialmente pericoloso' : 'Innocuo' }}
              </span>
            </div>
          </div>
          <ng-template #noAdditivi>Nessuno</ng-template>
        </div>
      </ion-label>
    </ion-item>

    <ion-item>
      <ion-label>
        <strong>ALLERGENI:</strong>
        <div class="value-list">
          <div *ngIf="prodotto.allergeni?.length; else noAllergeni">
            <div *ngFor="let allergene of prodotto.allergeni" class="allergene-wrapper">
              <div class="allergene-pill">
                {{ allergene }}
              </div>
              <div *ngIf="isUserAllergic(allergene)" class="allergene-warning">
                SEI ALLERGICO A QUESTO ALLERGENE!
              </div>
            </div>
          </div>
          <ng-template #noAllergeni>Nessuno</ng-template>
        </div>
      </ion-label>
    </ion-item>
    
    
    

    <ion-item >
      <ion-label>
        <h2><strong>Valori Nutrizionali</strong></h2>
        <div class="nutrient-list">
          <div class="nutrient">
            <span class="label">Energia:</span>
            <span class="value">{{ prodotto.nutrienti?.energia }} kcal</span>
          </div>
          <div class="nutrient">
            <span class="label">Carboidrati:</span>
            <span class="value">{{ prodotto.nutrienti?.carboidrati }} g</span>
          </div>
          <div class="nutrient">
            <span class="label">Grassi:</span>
            <span class="value">{{ prodotto.nutrienti?.grassi }} g</span>
          </div>
          <div class="nutrient">
            <span class="label">Proteine:</span>
            <span class="value">{{ prodotto.nutrienti?.proteine }} g</span>
          </div>
          <div class="nutrient">
            <span class="label">Sale:</span>
            <span class="value">{{ prodotto.nutrienti?.sale }} g</span>
          </div>
        </div>
      </ion-label>
    </ion-item>

      
      <ion-item>
        <div class="button-group">
          <ion-button fill="solid" [disabled]="alreadyInPantry()">
            Aggiungi in dispensa
          </ion-button>
      
          <ion-button fill="solid" (click)="openMealActionSheet()">
            Aggiungi al pasto
          </ion-button>
        </div>
      </ion-item>

  </ion-list>
</ion-content>
